\documentclass[12pt,a4paper]{article}
\usepackage[margin=2cm]{geometry}
\usepackage{amsmath,amsfonts,amsthm}
\usepackage{graphicx}
\usepackage{biblatex}
\usepackage{cleveref}
\bibliography{MLnotes}
\title{Notes on the Mittag--Leffler function}
\author{William McLean}
\date{\today}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newtheorem{theorem}{Theorem}
\newtheorem{lemma}[theorem]{Lemma}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\DeclareMathOperator*{\res}{res}
\newcommand{\arcosh}{\operatorname{arcosh}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% % %
\begin{document}
\maketitle
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
The two-argument, Mittag--Leffler function is defined by the power series
\begin{equation}\label{eq: E alpha beta def}
E_{\alpha,\beta}(z)=\sum_{n=0}^\infty\frac{z^n}{\Gamma(\beta+n\alpha)}
\quad\text{for $z\in\mathbb{C}$, $\alpha>0$, $\beta>0$.}
\end{equation}
The reciprocal of the Gamma function may be written as an integral along a
Hankel contour,
\[
\frac{1}{\Gamma(\beta+n\alpha)}=\frac{1}{2\pi i}\int_{-\infty}^{0^+}
    \frac{e^w\,dw}{w^{\beta+n\alpha}},
\]
where we take a branch cut along the negative real axis so that 
$-\pi<\arg w<\pi$. Therefore, if $|z|<|w^\alpha|$ for all~$w$ on the contour, 
then
\[
E_{\alpha,\beta}(z)=\frac{1}{2\pi i}\int_{-\infty}^{0^+}\frac{e^w}{w^\beta}
    \sum_{n=0}^\infty(zw^{-\alpha})^n\,dw
    =\frac{1}{2\pi i}\int_{-\infty}^{0^+}\frac{e^w}{w^\beta}\,
    \frac{dw}{1-zw^{-\alpha}},
\]
and so
\begin{equation}\label{eq: integral repn}
E_{\alpha,\beta}(z)=\frac{1}{2\pi i}\int_{-\infty}^{0^+}
    \frac{e^w\,dw}{w^\beta-zw^{\beta-\alpha}}.
\end{equation}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Quadrature approximations}
Assume $t>0$ and $0<\alpha<1$.  Then
\[
E_{\alpha,\beta}(-t^\alpha)=\frac{1}{2\pi i}\int_{-\infty}^{0^+}
    \frac{e^w\,dw}{w^{\beta-\alpha}(w^\alpha+t^\alpha)},
\]
and $w^\alpha+t^\alpha\ne0$ since $|\arg w^\alpha|=\alpha|\arg w|<\alpha\pi$.  
Making the substitution~$w=tz$, we obtain
\[
E_{\alpha,\beta}(-t^\alpha)=\frac{t^{1-\beta}}{2\pi i}\int_{-\infty}^{0^+}
    e^{tz}F_-(z)\,dz
\quad\text{where}\quad F_-(z)=\frac{1}{z^{\beta-\alpha}(z^\alpha+1)}.
\]
For positive arguments of the Mittag--Leffler functions, the representation
\[
E_{\alpha,\beta}(t^\alpha)=\frac{1}{2\pi i}\int_{-\infty}^{0^+}
    \frac{e^w\,dw}{w^{\beta-\alpha}(w^\alpha-t^\alpha)}
\]
is valid only if the Hankel contour passes to the right of the pole 
at~$w=t$.  Considering the residue
\[
\res_{w\to t}\frac{1}{w^\alpha-t^\alpha}
    =\lim_{w\to t}\frac{w-t}{w^\alpha-t^\alpha}
    =\frac{1}{\alpha t^{\alpha-1}},
\]
we have
\[
E_{\alpha,\beta}(t^\alpha)=\alpha^{-1}t^{1-\beta}e^t
    +\frac{1}{2\pi i}\int_{-\infty}^{0^+}\frac{e^w}{w^{\beta-\alpha}}
    \biggl(\frac{1}{w^\alpha-t^\alpha}
    -\frac{1}{\alpha t^{\alpha-1}(w-t)}\biggr)\,dw,
\]
where the integrand is now analytic in the cut plane.  We again make the 
substitution~$w=tz$, obtaining
\[
E_{\alpha,\beta}(t^\alpha)=t^{1-\beta}\biggl(\alpha^{-1}e^t
    +\frac{1}{2\pi i}\int_{-\infty}^{0^+}e^{tz}F_+(z)\,dz\biggr),
\]
where
\[
F_+(z)=\frac{1}{z^{\beta-\alpha}}\biggl(\frac{1}{z^\alpha-1}
    -\frac{1}{\alpha(z-1)}\biggr).
\]

Thus, we are led to the problem of evaluating the Bromwich integral
\[
I(t)=\frac{1}{2\pi i}\int_{-\infty}^{0^+}e^{tz}F(z)\,dz,
\]
for $F(z)$ analytic in the cut plane. Following Weideman and 
Trefethen~\cite{WeidemanTrefethen2007} we use the Hankel contour parameterised 
by
\[
z(u)=\mu\bigl(1+\sin(iu-\phi)\bigr)\quad\text{for $-\infty<u<\infty$,}
\]
with $\mu>0$ and $0<\phi<\pi/2$, to express~$I$ as an integral on the real line,
\[
I(t)=\frac{1}{2\pi i}\int_{-\infty}^\infty e^{tz(u)}F\bigl(z(u)\bigr)z'(u)\,du.
\]
Since
\begin{align*}
\Re z&=\mu(1-\cosh u\,\sin\phi),\\
\Im z&=\mu\sinh u\,\cos\phi,
\end{align*}
we have
\[
\biggl(\frac{\Re z-1}{\mu\sin\phi}\biggr)^2
    -\biggl(\frac{\Im z}{\mu\cos\phi}\biggr)^2=1,
\]
showing that the contour is the left branch of an hyperbola with asymptotes
\[
\Im z=\pm(\Re z-1)\tan\phi.
\]
For a step size~$h>0$, let
\[
u_n=nh,\qquad z_n=z(u_n),\qquad z'_n=z'(u_n)
\]
and define the series approximation
\[
I_h(t)=\frac{h}{2\pi i}\sum_{n=-\infty}^\infty e^{tz_n}F(z_n)z'_n.
\]
For a fixed~$v$ with $0<\phi+v<\pi/2$, we see that
$z(u+iv)=\mu\bigl[1+\sin(iu-(\phi+v)\bigr)\bigr]$ parameterises the left branch 
of an hyperbola with asymptotes
\[
\Im z=\pm(\Re z-1)\tan(\phi+v).
\]
Putting
\[
M(t,v)=\int_{-\infty}^\infty\bigl|\exp\bigl(tz(u+iv)\bigr)
    F\bigl(z(u+iv)\bigr)z'(u+iv)\bigr|\,du
    \quad\text{for $-\phi<v<\frac{\pi}{2}$,}
\]
we have the error bound~\cite[Theorem~2.1]{WeidemanTrefethen2007}
\[
|I_h(t)-I(t)|\le\frac{M(t,r)}{\exp(2\pi r/h)-1}
    +\frac{M(t,-s)}{\exp(2\pi s/h)-1}
\]
for $0<s<\phi$ and $0<r<\pi/2-\phi$.  For the truncated sum,
\[
I_{h,N}(t)=\frac{h}{2\pi i}\sum_{n=-N}^N e^{tz_n}F(z_n)z'_n,
\]
we have an additional truncation error
\[
T_{h,N}=\sum_{n=N+1}^\infty\bigl(e^{tz_n}F(z_n)z'_n
    +e^{tz_{-n}}F(z_{-n})z'_{-n}\bigr).
\]
Choosing the largest possible values $s=\phi$~and $r=\pi/2-\phi$, the three
error terms are of order $\exp\bigl(-(\pi^2-2\pi\phi)/h\bigr)$,
$\exp(\mu t-2\pi\phi/h)$ and $\exp\bigl(\mu t(1-\cosh(Nh)\sin\phi)\bigr)$.
To balance these quantities, we seek to choose the parameters so that
\cite[(4.2)]{WeidemanTrefethen2007}
\[
-\frac{\pi^2-2\pi\phi}{h}=\mu t-\frac{2\pi\phi}{h}
    =\mu t\bigl(1-\cosh(Nh)\sin\phi\bigr).
\]
The left-hand equation implies that
\[
\mu t=\frac{4\pi\phi-\pi^2}{h},
\]
which allows us to eliminate $\mu t$ in the right-hand equation, to obtain
\[
\cosh(Nh)=\frac{2\pi\phi}{(4\phi-\pi)\pi\sin\phi}.
\]
We therefore define
\[
A(\phi)=\arcosh\biggl(\frac{2\pi\phi}{(4\phi-\pi)\pi\sin\phi}\biggr)
\quad\text{for $\frac{\pi}{4}<\phi<\frac{\pi}{2}$,}
\]
and set
\[
h=\frac{A(\phi)}{N}\quad\text{and}\quad
\mu=\frac{4\pi\phi-\pi^2}{A(\phi)}\,\frac{N}{t},
\]
so that the error~$I_{h,N}(t)-I(t)$ is order~$e^{-B(\alpha)N}$ for
\begin{equation}\label{eq: B function}
B(\phi)=\frac{\pi^2-2\pi\phi}{A(\phi)}.
\end{equation}
\Cref{fig: B plot} shows a plot of~$B(\phi)$, and we find using a standard 
optimization package that the maximum value occurs at
\[
\phi_\star=1.172104\quad\text{with}\quad B(\phi_\star)=2.315654.
\]
The corresponding values for the other parameters are
\[
h_\star=\frac{1.081792}{N}\quad\text{and}\quad
\mu_\star=4.492075\,\frac{N}{t}.
\]
Since $e^{B(\phi_\star)}=10.131547$ we expect to gain about an extra decimal
digit of accuracy each time we increase $N$ by~$1$.



\begin{figure}
\caption{Plot of the function~\eqref{eq: B function} showing the 
maximum at~$\phi_\star$.}\label{fig: B plot}
\begin{center}
\includegraphics[scale=0.75]{Bplot.pdf}
\end{center}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Asymptotic expansion}
Since
\[
\frac{1}{w^\beta-zw^{\beta-\alpha}}=\frac{-1}{zw^{\beta-\alpha}}
    \,\frac{1}{1-w^\alpha z^{-1}}
\]
and
\[
\frac{1}{1-w^\alpha z^{-1}}=\sum_{n=0}^N(w^\alpha z^{-1})^n
    +\frac{(w^\alpha z^{-1})^{N+1}}{1-w^\alpha z^{-1}},
\]
we see from~\eqref{eq: integral repn} that
\[
E_{\alpha,\beta}(z)=\sum_{n=0}^N\frac{-1}{2\pi i}\int_{-\infty}^{0^+}
    \frac{e^w(w^\alpha z^{-1})^n}{zw^{\beta-\alpha}}\,dw+R_N(z),
\]
where the remainder term is
\[
R_N(z)=\frac{-1}{2\pi i}\int_{-\infty}^{0^+}
    \frac{e^w(w^\alpha z^{-1})^{N+1}\,dw}{zw^{\beta-\alpha}(1-w^\alpha z^{-1})}.
\]
The $n$th term equals
\[
\frac{-z^{-1-n}}{2\pi i}\int_{-\infty}^{0^+}e^w w^{(n+1)\alpha-\beta}\,dw,
\]
and if we assume $\alpha-\beta>-1$ then by collapsing the contour onto the 
negative real axis and using the substitutions~$w=re^{\pm i\pi}$, we obtain
\[
\frac{-1}{2\pi i}\int_{-\infty}^{0^+}e^w w^{(n+1)\alpha-\beta}\,dw
    =\frac{e^{i\pi[(n+1)\alpha-\beta]}-e^{-i\pi[(n+1)\alpha-\beta]}}{2\pi i}
    \int_0^\infty e^{-r}r^{(n+1)\alpha-\beta}\,dr
\]
so
\[
E_{\alpha,\beta}(z)=R_N(z)+\frac{1}{\pi}\sum_{n=0}^N
    \sin\pi[(n+1)\alpha-\beta]\,\Gamma\bigl((n+1)\alpha-\beta+1\bigr)z^{-1-n}.
\]
Also,
\[
R_N(z)=\frac{z^{-1-N}}{2\pi i}\int_{-\infty}^{0^+}
    \frac{e^w w^{(N+2)\alpha-\beta}}{w^\alpha-z}\,dw
\]
If $z=x>0$, then this integrand has a pole at~$w=x^{1/\alpha}$ (in addition to
the branch point at~$w=0$) so we collect a residue when collapsing the contour 
onto the negative real axis.  Since
\[
\res_{w\to x^{1/\alpha}}\frac{e^w w^{(N+2)\alpha-\beta}}{w^\alpha-x}
    =\exp(x^{1/\alpha})\,x^{(N+2)-\beta/\alpha}\lim_{w\to x^{1/\alpha}}
    \frac{w-x^{1/\alpha}}{w^\alpha-x},
\]
and the limit equals $x^{-1+1/\alpha}/\alpha$, we find that
\[
R_N(x)=\frac{x^{(1-\beta)/\alpha}}{\alpha}\,\exp(x^{1/\alpha})
    +\frac{x^{-1-N}}{2\pi i}\int_0^\infty e^{-r}r^{(N+2)\alpha-\beta}\biggr(
     \frac{e^{-i\pi[(N+2)\alpha-\beta]}}{r^\alpha e^{-i\pi\alpha}-x}
    -\frac{e^{i\pi[(N+2)\alpha-\beta]}}{r^\alpha e^{i\pi\alpha}-x}\biggr)\,dr.
\]
Here,
\[
\frac{1}{2i}\biggr(
     \frac{e^{-i\pi[(N+2)\alpha-\beta]}}{r^\alpha e^{-i\pi\alpha}-x}
    -\frac{e^{i\pi[(N+2)\alpha-\beta]}}{r^\alpha e^{i\pi\alpha}-x}\biggr)
    =\frac{r^\alpha\sin\pi[\beta-(N+1)\alpha]+x\sin\pi\alpha}%
{(r^\alpha-x\cos\pi\alpha)^2+x^2\sin^2\pi\alpha},
\] 
so we have
\[
E_{\alpha,\beta}(x)=\frac{x^{(1-\beta)/\alpha}}{\alpha}\,\exp(x^{1/\alpha})
    +\frac{1}{\pi}\sum_{n=0}^N
    \sin\pi[(n+1)\alpha-\beta]\,\Gamma\bigl((n+1)\alpha-\beta+1\bigr)x^{-1-n}
    +\tilde R_N(x),
\]
where
\[
\tilde R_N(x)=\frac{x^{-1-N}}{\pi}\int_0^\infty e^{-r}r^{(N+2)\alpha-\beta}
    \frac{r^\alpha\sin\pi[\beta-(N+1)\alpha]+x\sin\pi\alpha}%
{(r^\alpha-x\cos\pi\alpha)^2+x^2\sin^2\pi\alpha}\,dr.
\]

If $z=-x$ for~$x>0$, then we obtain in the same way
\begin{equation}\label{eq: E minus asymptotic}
E_{\alpha,\beta}(-x)=\frac{1}{\pi}\sum_{n=0}^N(-1)^{n+1}
    \sin\pi[(n+1)\alpha-\beta]\,\Gamma\bigl((n+1)\alpha-\beta+1\bigr)x^{-1-n}
    +R_N(-x).
\end{equation}
with
\[
R_N(-x)=(-1)^{N+1}\,\frac{x^{-1-N}}{\pi}\int_0^\infty 
    e^{-r}r^{(N+2)\alpha-\beta}
    \frac{r^\alpha\sin\pi[\beta-(N+1)\alpha]-x\sin\pi\alpha}%
{(r^\alpha+x\cos\pi\alpha)^2+x^2\sin^2\pi\alpha}\,dr.
\]
Let
\begin{equation}\label{eq: Cpm}
C_\pm(\alpha, \beta, N)=\sup_{0\le y<\infty}
    \biggl|\frac{ay\pm b}{(y\mp c)^2+b^2}\biggr|
\end{equation}
where
\begin{equation}\label{eq: A B C}
a=\sin\pi[\beta-(N+2)\alpha],\qquad b=\sin\pi\alpha,\qquad c=\cos\pi\alpha,
\end{equation}
and note that
\[
\int_0^\infty e^{-r}r^{(N+2)\alpha-\beta}\,dr
    =\Gamma\bigl((N+2)\alpha-\beta+1\bigr).
\]
Thus,
\[
|\tilde R_N(x)|\le\frac{C_+(\alpha,\beta,N)}{\pi}\,
    \Gamma\bigl((N+2)\alpha-\beta+1\bigr)x^{-2-N}
\]
and
\[
|R_N(-x)|\le\frac{C_-(\alpha,\beta,N)}{\pi}\,
    \Gamma\bigl((N+2)\alpha-\beta+1\bigr)x^{-2-N}.
\]

\begin{lemma}
Consider $C_\pm(\alpha,\beta,N)$ defined by \eqref{eq: Cpm}~and 
\eqref{eq: A B C}.
\begin{enumerate}
\item
If $a=0$ and $c\ge0$, then
\[
C_+(\alpha, \beta, N)=\frac{1}{|b|}\quad\text{and}\quad
C_-(\alpha, \beta, N)=|b|.
\]
\item 
If $a=0$ and $c<0$, then
\[
C_+(\alpha, \beta, N)=|b|\quad\text{and}\quad
C_-(\alpha, \beta, N)=\frac{1}{|b|}.
\]
\item
Otherwise, if $a\ne0$, then we let $S_\pm$ denote the set of positive (real) 
roots of the quadratic equation
\begin{equation}\label{eq: A B C quadratic}
ay^2\pm2by-(a+2bc)=0.
\end{equation}
\begin{enumerate}
\item If $S=\emptyset$, then
\[
C_+(\alpha, \beta, N)=|b|\quad\text{and}\quad C_-(\alpha, \beta, N)=|b|.
\]
\item If $S\ne\emptyset$, then
\[
C_\pm(\alpha,\beta,N)=\max\biggl(|b|,
\max_{y\in S_\pm}\biggl|\frac{ay\pm b}{(y\mp c)^2+b^2}\biggr|\biggr).
\]
\end{enumerate}
\end{enumerate}
\end{lemma}
\begin{proof}
Let
\[
f_\pm(y)=\frac{ay\pm b}{(y\mp c)^2+b^2},
\]
and observe that $f_\pm(0)=B$ because $b^2+c^2=1$, and that $f_\pm(y)\to0$ 
as~$y\to\infty$.  If $a=0$~and $c\ge0$, then $|f_+(y)|\le|f_+(c)|=|b|^{-1}$
for~$0\le y<\infty$, whereas $|f_-(y)|\le|f_-(0)|=|b|$.  If $a=0$~and $c<0$,
then $|f_+(y)|\le|f_+(0)|=|b|$~and $|f_-(y)|\le|f_-(c)|=|b|^{-1}$ instead.

It remains to deal with the case~$a\ne0$.  We see that $f_\pm'(y)=0$ if and 
only if
\[
a[(y\mp c)^2+b^2]=2(ay\pm b)(y\mp c),
\]
which simplifies to give the quadratic equation~\eqref{eq: A B C quadratic}.
The maximum value of~$|f_\pm(y)|$ must occur either at~$y=0$ or at an element 
of~$S_\pm$.
\end{proof}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Chebyshev expansion}
Consider the substitution
\[
y=\frac{x-1}{x+1}\quad\text{for $0\le x<\infty$.}
\]
The function~$x\mapsto y$ maps the half-line~$[0,\infty)$ onto~$[-1,1)$, and 
the inverse function~$y\mapsto x$ is given by
\[
x=\frac{1+y}{1-y}\quad\text{for $-1\le y<1$.}
\]
We define a function~$g$ by requiring that
\[
E_{\alpha,\beta}(-x)=1+xg(y).
\]
On the one hand, the power series~\eqref{eq: E alpha beta def} implies that
\[
g(y)=\frac{1}{x}\sum_{n=1}^\infty\frac{(-x)^n}{\Gamma(\beta+n\alpha)}
    =\sum_{n=1}^\infty\frac{(-1)^n}{\Gamma(\beta+n\alpha)}\,\biggl(
    \frac{1+y}{1-y}\biggr)^{n-1}\quad\text{for $-1\le y<1$,}
\]
and on the other hand, the asymptotic expansion~\eqref{eq: E minus asymptotic}
implies that
\begin{align*}
g(y)&=\frac{1}{x}\biggl(-1+\frac{1}{\pi}\,\sin\pi(\alpha-\beta)\,
    \Gamma(1+\alpha-\beta)x^{-1}+O(x^{-2})\biggr)&
&\text{as $x\to\infty$,}\\
    &=\frac{1-y}{1+y}\biggl(-1+\frac{1}{\pi}\,\sin\pi(\alpha-\beta)\,
\Gamma(1+\alpha-\beta)\frac{1-y}{1+y}+O\bigl((1-y)^2\bigr)\biggr)&
&\text{as $y\to1$.}
\end{align*}
In particular, $g(-1)=-1/\Gamma(\beta+\alpha)$ and $g(1)=0$.






%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\printbibliography
\end{document}

